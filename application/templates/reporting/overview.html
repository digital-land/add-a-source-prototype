{% extends 'layouts/base.html' %}
{% block beforeContent %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<div class="govuk-breadcrumbs">
  <ol class="govuk-breadcrumbs__list">
    <li class="govuk-breadcrumbs__list-item">
      <a class="govuk-breadcrumbs__link" href="{{ url_for('base.index') }}">Home</a>
    </li>
    <li class="govuk-breadcrumbs__list-item">
      reporting
    </li>
  </ol>
</div>
{% endblock beforeContent %}

{% block content %}

<h1 class="govuk-heading-xl">Reporting - overview</h1>

<h2>Contributions: {{ overview.contributions }}</h2>
<h2>Endpoint errors: {{ overview.errors }}</h2>

<h2>Endpoints added per week:</h2>
<div>
  <canvas id="endpoint_added_graph"></canvas>
</div>


<h2>Resources downloaded per week:</h2>
<div>
  <canvas id="resources_downloaded_graph"></canvas>
</div>

<script>
  const endpoints_ctx = document.getElementById('endpoint_added_graph');

  new Chart(endpoints_ctx, {
    type: 'line',
    data: {
      labels: {{overview.endpoints_added.dates | safe}},
      datasets: [{
        label: '# of endpoints added per week',
        data: {{overview.endpoints_added.counts | safe}},
        borderWidth: 1
      }]
    },
    options: {
      scales: {
        y: {
          title: {
            display: true,
            text: "Endpoints added"
        },
          beginAtZero: true
        },
        x: {
          title: {
            display: true,
            text: "Week"
        }
      }
    }
  }});
</script>

<script>
  const resources_ctx = document.getElementById('resources_downloaded_graph');

  new Chart(resources_ctx, {
    type: 'line',
    data: {
      labels: {{overview.resources_downloaded.dates | safe}},
      datasets: [{
        label: '# of resources downloaded per week',
        data: {{overview.resources_downloaded.counts | safe}},
        borderWidth: 1
      }]
    },
    options: {
      scales: {
        y: {
          title: {
            display: true,
            text: "Resources downloaded"
        },
        },
        x: {
          title: {
            display: true,
            text: "Week"
        }
      }
    }
  }});
</script>

<script>
  console.log({{overview.resources_downloaded.counts | safe}})
</script>
{% endblock content %}
